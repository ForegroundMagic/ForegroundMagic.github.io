*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at top, #080E19 0%, #0A1222 70%, #080E19 100%);
  color: #f7f8ff;
}

/* Static margin from viewport edges to keep panels floating */
.app-container {
  position: fixed;
  inset: 12px;               /* 24px margin on all sides */
  display: flex;
  flex-direction: column;
  gap: 12px;                 /* vertical gap between panels */
}

/* Shared panel styles */
.panel {
  background: #0E1522;
  border-radius: var(--panel-radius);
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 0 18px 45px rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  overflow: hidden;
}

/* Top panel ~35% of available vertical space inside the margin box */
.panel-top {
  flex: 0 0 30%;
  display: flex;
}

.panel-top > .top-toolbar {
  flex: 1 1 auto;
}

/* Bottom panel fills remaining vertical space */
.panel-bottom {
  flex: 1 1 auto;
}

/* Small-screen tweaks (keep same outer margin, soften radii) */
@media (max-width: 640px) {
  :root {
    --panel-radius: 14px;
  }
}


/* === Toolbar variables and layout (imported from legacy header) === */
:root{
  --page-gap: clamp(10px, 3.5vw, 24px);
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);

  /* Header row heights */
  --header-top-h: clamp(56px, 10vh, 88px);
  --headers-toolbar-h: clamp(28px, 5vh, 36px);   /* middle row just for headers */
  --header-third-h: clamp(56px, 10vh, 88px);

  /* Color System */
  --bg: #0b1220;
  --surface-1: #101826;
  --surface-2: #0e1522;
  --surface-3: #121a2b;
  --surface-headers: #080C16;  /* darker middle header row per request */
  --panel-bar: #0d1528;
  --text: #e5e9f3;
  --text-muted: #98a3b8;
  --border: 1px solid rgba(255,255,255,0.08);
  --shadow: 0 10px 30px rgba(0,0,0,0.55);
  --radius: 14px;
  --panel-radius: 18px;

  --accent: #7c9dfb;
  --accent-600: #5f86fb;
  --accent-glow: 0 0 0 3px rgba(124,157,251,0.25);

  /* Toolbar sizing */
  --tool-icon: clamp(20px, 5.2vh, 28px);
  --tool-label: clamp(10px, 1.7vh, 13px);
  --tool-gap: 4px;

  /* View toolbar */
  --view-toolbar-h: clamp(36px, 5.5vh, 48px);
  --view-icon: clamp(16px, 4vh, 22px);
  --view-label: clamp(10px, 1.5vh, 12px);
  --view-gap: 2px;

  /* Dividers */
  --divider-color-headers: rgba(255,255,255,0.18);
  --header-border-color: rgba(255,255,255,0.06);
}

/* === 3-row toolbar header === */
.top-toolbar{
  display: grid;
  grid-template-rows: var(--header-top-h) var(--headers-toolbar-h) var(--header-third-h);
  overflow: clip; min-width: 0;
}

/* Row 1: Brand + Section Tabs */
.header-row-top{
  display: grid; grid-template-columns: repeat(6, 1fr); align-items: center;
  padding: 0; gap: 0; min-width: 0; background: var(--surface-2);
  border-top-left-radius: var(--radius); border-top-right-radius: var(--radius);
}
.brand{
  grid-column: 1 / span 3; display: flex; align-items: center; gap: 10px; min-width: 0; padding-inline: 8px; height: 100%;
}
.brand__logo{
  width: 32px; height: 32px; border-radius: 8px;
  background: conic-gradient(from 210deg, #5f86fb, #7c9dfb, #67e8f9, #5f86fb);
  box-shadow: inset 0 0 0 2px rgba(255,255,255,0.06), 0 8px 18px rgba(95,134,251,0.35);
  flex: 0 0 auto;
}
.brand__name{ font-weight: 800; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; color: var(--text); letter-spacing: .2px; }
.header-tools{
  grid-column: 4 / span 3; display: grid; grid-template-columns: repeat(3, 1fr);
  height: 100%; overflow: clip; background: var(--surface-2);
}

/* Row 2: Toolbar Headers (inert buttons with ONLY boundary dividers) */
.header-row-headers{
  display: grid; grid-auto-rows: 1fr; background: var(--surface-headers);
  }
.headers-deck{ position: relative; height: 100%; display: grid; }
.headers-block{
  display: grid; grid-area: 1 / 1; grid-template-columns: repeat(6, 1fr);
  opacity: 0; pointer-events: none; transition: opacity 150ms ease;
  align-items: stretch; background: var(--surface-headers);
}
html[data-active-section="explore"]  .headers-block[data-section="explore"],
html[data-active-section="customize"] .headers-block[data-section="customize"],
html[data-active-section="order"]     .headers-block[data-section="order"]{
  opacity: 1; pointer-events: auto;
}
.header-row-headers .tool{
  display: grid; place-items: center; height: 100%;
  padding: 0; gap: 0; border-radius: 0; pointer-events: none; cursor: default;
  background: transparent; color: var(--text);
  border: 1px solid var(--header-border-color);
  /* keep border inside the allocated area */
  box-sizing: border-box;
}
.header-row-headers .tool__label{ font-size: var(--view-label); font-weight: 600; }


/* Row 3: Toolbars (interactive) */
.header-row-toolbar{
  display: grid; grid-auto-rows: 1fr; background: var(--surface-2);
  border-bottom-left-radius: var(--radius); border-bottom-right-radius: var(--radius);
}
.toolbar-deck{ position: relative; height: 100%; display: grid; }
.toolbar-block{
  display: grid; grid-area: 1 / 1;
  opacity: 0; pointer-events: none; transition: opacity 150ms ease; height: 100%;
  background: var(--surface-2);
}
html[data-active-section="explore"]  .toolbar-block[data-section="explore"],
html[data-active-section="customize"] .toolbar-block[data-section="customize"],
html[data-active-section="order"]     .toolbar-block[data-section="order"]{
  opacity: 1; pointer-events: auto;
}
.toolbar{
  display: grid; grid-template-columns: repeat(6, 1fr); padding: 0; overflow: clip;
  height: 100%;
}

/* Buttons (shared visuals) */
.tool{
  display: grid; grid-template-rows: auto auto; align-content: center; justify-items: center;
  gap: var(--tool-gap); width: 100%; height: 100%; border: 0; background: transparent; font: inherit; cursor: pointer; padding: 6px 0; position: relative;
  color: var(--text-muted);
}
.tool:focus-visible{ outline: 2px solid var(--accent-600); outline-offset: -2px; border-radius: 12px; box-shadow: var(--accent-glow); }
.tool:hover{ background: rgba(124,157,251,0.12); }
.tool:active{ background: rgba(124,157,251,0.18); }
.tool[aria-pressed="true"] .tool__icon, .tool[aria-pressed="true"] .tool__label{ color: var(--accent); font-weight: 700; }
.tool__icon{ width: var(--tool-icon); height: var(--tool-icon); color: currentColor; }
.tool__label{ font-size: var(--tool-label); line-height: 1; color: currentColor; user-select: none; }
.tool__icon svg{ width: 100%; height: 100%; display: block; }
.header-row-top .tool__icon{ color: #f7f8ff; }
.header-row-toolbar .tool__icon{ color: #f7f8ff; }

.header-tools .tool.is-active {
  background: rgba(124, 157, 251, 0.16);
  box-shadow: inset 0 -3px 0 var(--accent-600);
  color: var(--accent);
}

/* === Overrides added by ChatGPT on 2025-11-09 === */
/* Ensure .top-toolbar fills the entire .panel-top without padding, and split vertically 40%/20%/40% */
.panel.panel-top, .panel-top { padding: 0 !important; }

.panel-top > .top-toolbar, .panel.panel-top > .top-toolbar {
  width: 100% !important;
  height: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
}

.panel-top .top-toolbar {
  display: grid !important;
  grid-template-rows: 40% 20% 40% !important;
  height: 100% !important;
}

/* (Optional) ensure rows stretch fully if they are flex items inside */
.panel-top .top-toolbar > * {
  min-height: 0;
}

/* === Rounding + clipping for top panel (2025-11-09) === */
.panel-top, .panel.panel-top {
  border-radius: var(--panel-radius, 12px) !important;
  overflow: hidden !important; /* keep children (buttons) inside rounded corners */
}

/* Ensure children can't overflow the panel bounds */
.panel-top * {
  box-sizing: border-box;
  max-width: 100%;
}

.panel-top .top-toolbar,
.panel.panel-top .top-toolbar {
  min-width: 0;
  min-height: 0;
}

.panel-top .top-toolbar > * {
  min-width: 0;
  min-height: 0;
  overflow: hidden; /* clip inner overflows such as long labels */
}

/* Keep buttons within available space */
.panel-top .top-toolbar button,
.panel-top .top-toolbar .btn {
  max-width: 100%;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}

/* === Order section layout (2025-11-09) === */
.order-grid {
  display: grid !important;
  grid-template-columns: repeat(6, 1fr) !important;
  gap: var(--gap, 8px);
}

.order-grid > [data-span="1"] { grid-column: span 1; }
.order-grid > [data-span="2"] { grid-column: span 2; }
.order-grid > [data-span="3"] { grid-column: span 3; }
.order-grid > [data-span="4"] { grid-column: span 4; }
.order-grid > [data-span="5"] { grid-column: span 5; }
.order-grid > [data-span="6"] { grid-column: span 6; }

/* Ensure items don't overflow their grid cells */
.order-grid > * {
  min-width: 0;
  min-height: 0;
  overflow: hidden;
}
