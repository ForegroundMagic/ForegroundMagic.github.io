<!doctype html>
<html lang="en" data-active-section="wares" data-design-page="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3-Row Layout — Overlays for Design Tools</title>
  <style>
    /* ============ 0) Base + Reset ============ */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      min-height: 100dvh;
      overflow: hidden;
      background: #f3f5f7;
      color: #111;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.4;
    }

    /* ============ 1) Theme Variables ============ */
    :root{
      --page-gap: clamp(10px, 3.5vw, 24px);

      --safe-top: env(safe-area-inset-top, 0px);
      --safe-right: env(safe-area-inset-right, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-left: env(safe-area-inset-left, 0px);

      --header-h: clamp(56px, 10vh, 88px);
      --toolbar-h: clamp(56px, 10vh, 96px);

      --radius: 14px;
      --surface: #fff;
      --surface-alt: #fcfdff;
      --border: 1px solid rgba(0,0,0,0.06);
      --shadow: 0 6px 20px rgba(0,0,0,0.06);

      /* Toolbar-specific */
      --tool-icon: clamp(20px, 5.2vh, 28px);
      --tool-label: clamp(10px, 1.7vh, 13px);
      --tool-gap: 4px;
      --tool-active: #0d6efd; /* accent for active state */

      /* Overlay colors per page */
      --page-color: #eaf6ff; /* default / fallback */
      --page-color-text: #0b2a3a;
    }

    /* ============ 2) Grid Shell (3 rows) ============ */
    .app{
      display: grid;
      grid-template-rows: var(--header-h) 1fr var(--toolbar-h);
      padding:
        calc(var(--page-gap) + var(--safe-top))
        calc(var(--page-gap) + var(--safe-right))
        calc(var(--page-gap) + var(--safe-bottom))
        calc(var(--page-gap) + var(--safe-left));
      gap: var(--page-gap);
      height: 100dvh;
      max-width: 1200px;
      margin-inline: auto;
    }

    /* ============ 3) Section Basics ============ */
    header, main, .toolbar{
      background: var(--surface);
      border: var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    main{
      overflow: auto;
      padding: 16px;
      display: grid;
      align-content: start;
      gap: 12px;
      position: relative; /* allow overlay to sit on top */
    }
    .card{
      background: #fff; border: var(--border); border-radius: 12px;
      padding: 14px; box-shadow: var(--shadow);
    }
    .card h3{ margin: 0 0 6px; font-size: 16px; }
    .muted{ color: #5b6470; }

    /* ============ 4) Header with brand (3/6) + header tools (3/6) ============ */
    header{
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      align-items: center;
      padding: 0 8px;
      gap: 0;
      min-width: 0;
    }
    .brand{
      grid-column: 1 / span 3;
      display: flex; align-items: center; gap: 10px; min-width: 0; padding-inline: 8px;
      height: 100%;
    }
    .brand__logo{
      width: 32px; height: 32px; border-radius: 8px;
      background: linear-gradient(135deg, #6ea8fe, #9ec5fe);
      flex: 0 0 auto;
    }
    .brand__name{
      font-weight: 800; white-space: nowrap; text-overflow: ellipsis; overflow: hidden;
    }

    /* Header tools mimic toolbar styling */
    .header-tools{
      grid-column: 4 / span 3;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      height: 100%;
      border-left: var(--border);
      overflow: clip;
    }

    /* ============ 5) Toolbar button (shared) ============ */
    .tool{
      display: grid;
      grid-template-rows: auto auto;
      align-content: center;
      justify-items: center;
      gap: var(--tool-gap);
      width: 100%;
      height: 100%;
      border: 0;
      background: transparent;
      font: inherit;
      cursor: pointer;
      padding: 6px 0 calc(6px + var(--safe-bottom));
      position: relative;
    }
    header .tool{ padding: 6px 0; } /* header doesn’t need safe-area padding */

    .tool:focus-visible{
      outline: 2px solid color-mix(in oklab, var(--tool-active) 65%, black);
      outline-offset: -2px;
      border-radius: 12px;
    }
    .tool:hover{ background: rgba(13,110,253,0.06); }
    .tool:active{ background: rgba(13,110,253,0.12); }

    .tool[aria-current="page"] .tool__icon,
    .tool[aria-current="page"] .tool__label{
      color: var(--tool-active);
      font-weight: 600;
    }
    .tool[aria-pressed="true"] .tool__icon,
    .tool[aria-pressed="true"] .tool__label{
      color: var(--tool-active);
      font-weight: 700;
    }
    .tool__icon{
      width: var(--tool-icon);
      height: var(--tool-icon);
      color: #222;
      flex: 0 0 auto;
    }
    .tool__label{
      font-size: var(--tool-label);
      line-height: 1;
      color: #222;
      user-select: none;
    }
    .tool__icon svg{ width: 100%; height: 100%; display: block; }

    /* ============ 6) Bottom multi-toolbars (one visible at a time) ============ */
    .toolbar-deck{
      position: relative;
      height: 100%;
      display: grid;
    }
    .toolbar{
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      padding: 0;
      overflow: clip;
      grid-area: 1 / 1;
      opacity: 0;
      pointer-events: none;
      transition: opacity 150ms ease;
    }
    /* Show the active toolbar based on html[data-active-section] */
    html[data-active-section="wares"]  .toolbar[data-section="wares"],
    html[data-active-section="design"] .toolbar[data-section="design"],
    html[data-active-section="order"]  .toolbar[data-section="order"]{
      opacity: 1;
      pointer-events: auto;
    }

    /* ============ 7) Overlay layer (Design pages) ============ */
    .overlay-layer{ /* sits over main only */
      position: absolute;
      inset: 0;
      display: grid;
      grid-template: 1fr / 1fr;
      pointer-events: none; /* disabled until a page is active */
    }
    .overlay-panel{
      grid-area: 1 / 1;
      display: grid;
      align-content: start;
      gap: 12px;
      padding: 16px;
      background: var(--page-color);
      color: var(--page-color-text);
      border-radius: inherit;
      border: var(--border);
      box-shadow: var(--shadow);
      opacity: 0;
      pointer-events: none;
      transform: translateY(6px);
      transition: opacity 160ms ease, transform 160ms ease;
      /* NEW: ensure it fills main and owns the scroll when open */
      height: 100%;
      overflow: auto;
    }
    .overlay-header{
      display: flex; align-items: center; justify-content: space-between;
    }
    .overlay-title{ font-weight: 800; letter-spacing: .2px; }
    .overlay-close{
      border: 0; background: rgba(0,0,0,0.06); border-radius: 10px; padding: 6px 10px; cursor: pointer;
    }

    /* When any design page is open, lock the underlying main scroll to prevent double scrollbars */
    html[data-design-page] main { overflow: hidden; }

    /* Active state switch driven by [data-design-page] on <html> */
    html[data-design-page="color"]  .overlay-layer{ pointer-events: auto; }
    html[data-design-page="designs"]  .overlay-layer{ pointer-events: auto; }
    html[data-design-page="elements"] .overlay-layer{ pointer-events: auto; }
    html[data-design-page="text"]     .overlay-layer{ pointer-events: auto; }
    html[data-design-page="edit"]     .overlay-layer{ pointer-events: auto; }
    html[data-design-page="layers"]   .overlay-layer{ pointer-events: auto; }

    html[data-design-page="color"]  .overlay-panel[data-page="color"],
    html[data-design-page="designs"] .overlay-panel[data-page="designs"],
    html[data-design-page="elements"] .overlay-panel[data-page="elements"],
    html[data-design-page="text"]    .overlay-panel[data-page="text"],
    html[data-design-page="edit"]    .overlay-panel[data-page="edit"],
    html[data-design-page="layers"]  .overlay-panel[data-page="layers"]{
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    /* Different colors per page */
    html[data-design-page="color"]   { --page-color:#ffe9e3; --page-color-text:#4a1f17; }
    html[data-design-page="designs"] { --page-color:#eaf6ff; --page-color-text:#0b2a3a; }
    html[data-design-page="elements"]{ --page-color:#eef8e6; --page-color-text:#1f3a0b; }
    html[data-design-page="text"]    { --page-color:#f4edff; --page-color-text:#2c0b3a; }
    html[data-design-page="edit"]    { --page-color:#fff7d6; --page-color-text:#3a2c0b; }
    html[data-design-page="layers"]  { --page-color:#f0f5f9; --page-color-text:#0b243a; }

    /* Reduce motion preference */
    @media (prefers-reduced-motion: reduce){
      * { scroll-behavior: auto !important; }
      .toolbar, .overlay-panel{ transition: none; }
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Three-row responsive layout with overlays">
    <!-- HEADER -->
    <header role="banner" aria-label="Header tools">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true"></div>
        <div class="brand__name">My App</div>
      </div>

      <!-- Right side: header mini-toolbar (Wares / Design / Order) -->
      <nav class="header-tools" role="navigation" aria-label="Section selector">
        <!-- Wares -->
        <button class="tool" type="button" data-section="wares" aria-label="Wares" aria-current="page">
          <span class="tool__icon" aria-hidden="true">
            <!-- Box / package -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M21 7.5 12 3 3 7.5l9 4.5 9-4.5Z"/>
              <path d="M3 7.5V16.5l9 4.5 9-4.5V7.5"/>
              <path d="M12 12v9"/>
            </svg>
          </span>
          <span class="tool__label">Wares</span>
        </button>

        <!-- Design -->
        <button class="tool" type="button" data-section="design" aria-label="Design">
          <span class="tool__icon" aria-hidden="true">
            <!-- Layout -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 3h12M6 21h12M4 7h16M8 7v10M16 7v10M4 17h16"/>
            </svg>
          </span>
          <span class="tool__label">Design</span>
        </button>

        <!-- Order -->
        <button class="tool" type="button" data-section="order" aria-label="Order">
          <span class="tool__icon" aria-hidden="true">
            <!-- Cart -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="9" cy="20" r="1.6"/>
              <circle cx="17" cy="20" r="1.6"/>
              <path d="M3 4h2l2.5 11.5a2 2 0 0 0 2 1.5h7a2 2 0 0 0 2-1.5L21 8H7"/>
            </svg>
          </span>
          <span class="tool__label">Order</span>
        </button>
      </nav>
    </header>

    <!-- MAIN -->
    <main role="main" aria-label="Content area">
      <section class="card">
        <h3>Responsive Middle</h3>
        <p class="muted">
          Tap a Design tool at the bottom to open its overlay page on top of this area.
        </p>
      </section>
      <section class="card">
        <h3>Overlays</h3>
        <p class="muted">
          Only one Design page is active at a time. Switching tools swaps pages and highlights the active button.
        </p>
      </section>

      <!-- Overlay layer sits inside main so it covers just the content area -->
      <div class="overlay-layer" aria-live="polite">
        <section class="overlay-panel" data-page="color" role="dialog" aria-modal="true" aria-labelledby="title-color">
          <div class="overlay-header">
            <h2 id="title-color" class="overlay-title">Color</h2>
            <button class="overlay-close" type="button" data-close="true" aria-label="Close Color">✕</button>
          </div>
          <p>Color tools page is active. (Demo content)</p>
        </section>

        <section class="overlay-panel" data-page="designs" role="dialog" aria-modal="true" aria-labelledby="title-designs">
          <div class="overlay-header">
            <h2 id="title-designs" class="overlay-title">Designs</h2>
            <button class="overlay-close" type="button" data-close="true" aria-label="Close Designs">✕</button>
          </div>
          <p>Designs browser page is active. (Demo content)</p>
        </section>

        <section class="overlay-panel" data-page="elements" role="dialog" aria-modal="true" aria-labelledby="title-elements">
          <div class="overlay-header">
            <h2 id="title-elements" class="overlay-title">Elements</h2>
            <button class="overlay-close" type="button" data-close="true" aria-label="Close Elements">✕</button>
          </div>
          <p>Elements library page is active. (Demo content)</p>
        </section>

        <section class="overlay-panel" data-page="text" role="dialog" aria-modal="true" aria-labelledby="title-text">
          <div class="overlay-header">
            <h2 id="title-text" class="overlay-title">Text</h2>
            <button class="overlay-close" type="button" data-close="true" aria-label="Close Text">✕</button>
          </div>
          <p>Text editor page is active. (Demo content)</p>
        </section>

        <section class="overlay-panel" data-page="edit" role="dialog" aria-modal="true" aria-labelledby="title-edit">
          <div class="overlay-header">
            <h2 id="title-edit" class="overlay-title">Edit</h2>
            <button class="overlay-close" type="button" data-close="true" aria-label="Close Edit">✕</button>
          </div>
          <p>Edit adjustments page is active. (Demo content)</p>
        </section>

        <section class="overlay-panel" data-page="layers" role="dialog" aria-modal="true" aria-labelledby="title-layers">
          <div class="overlay-header">
            <h2 id="title-layers" class="overlay-title">Layers</h2>
            <button class="overlay-close" type="button" data-close="true" aria-label="Close Layers">✕</button>
          </div>
          <p>Layers manager page is active. (Demo content)</p>
        </section>
      </div>
    </main>

    <!-- BOTTOM: three separate toolbars; only the active one is visible -->
    <div class="toolbar-deck" role="region" aria-label="Section toolbars">

      <!-- WARES TOOLBAR (6 placeholder tools) -->
      <nav class="toolbar" data-section="wares" role="navigation" aria-label="Wares tools">
        <!-- Placeholder buttons (same as previous version) -->
        <button class="tool" type="button" aria-label="Placeholder 1">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 3l9 5-9 5-9-5 9-5z"/>
              <path d="M21 8v8l-9 5-9-5V8"/>
              <path d="M12 13v8"/>
            </svg>
          </span>
          <span class="tool__label">Item</span>
        </button>
        <button class="tool" type="button" aria-label="Placeholder 2">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="7" height="7" rx="1.5"/>
              <rect x="14" y="3" width="7" height="7" rx="1.5"/>
              <rect x="3" y="14" width="7" height="7" rx="1.5"/>
              <rect x="14" y="14" width="7" height="7" rx="1.5"/>
            </svg>
          </span>
          <span class="tool__label">Grid</span>
        </button>
        <button class="tool" type="button" aria-label="Placeholder 3">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 13l-7 7-9-9 7-7 9 9z"/>
              <circle cx="15.5" cy="8.5" r="1.2"/>
            </svg>
          </span>
          <span class="tool__label">Tag</span>
        </button>
        <button class="tool" type="button" aria-label="Placeholder 4">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 3l3.4 6.9 7.6 1.1-5.5 5.3 1.3 7.5L12 20l-6.8 3.6 1.3-7.5L1 11.1l7.6-1.2L12 3z"/>
            </svg>
          </span>
          <span class="tool__label">Star</span>
        </button>
        <button class="tool" type="button" aria-label="Placeholder 5">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 21l9-9"/>
              <path d="M13 3l2 2M19 5l2 2M15 9l2 2M9 5l2 2"/>
            </svg>
          </span>
          <span class="tool__label">Wand</span>
        </button>
        <button class="tool" type="button" aria-label="Placeholder 6">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M13 2L3 14h7l-1 8 10-12h-7l1-8z"/>
            </svg>
          </span>
          <span class="tool__label">Bolt</span>
        </button>
      </nav>

      <!-- DESIGN TOOLBAR (wired to overlays) -->
      <nav class="toolbar" data-section="design" role="navigation" aria-label="Design tools">
        <button class="tool" type="button" aria-label="Color" data-tool="color">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 3a9 9 0 1 0 0 18h2a2.5 2.5 0 0 0 0-5h-1a3 3 0 0 1-3-3v-1a9 9 0 0 1 2-9Z"/>
              <circle cx="7.5" cy="10.5" r="1.2"/>
              <circle cx="9.5" cy="6.8" r="1.2"/>
              <circle cx="14.5" cy="6.8" r="1.2"/>
              <circle cx="16.5" cy="10.5" r="1.2"/>
            </svg>
          </span>
          <span class="tool__label">Color</span>
        </button>
        <button class="tool" type="button" aria-label="Designs" data-tool="designs">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 3h12M6 21h12M4 7h16M8 7v10M16 7v10M4 17h16"/>
            </svg>
          </span>
          <span class="tool__label">Designs</span>
        </button>
        <button class="tool" type="button" aria-label="Elements" data-tool="elements">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="8" height="8" rx="2"/>
              <circle cx="17" cy="7" r="4"/>
              <path d="M12 14l-4 7h8l-4-7Z"/>
            </svg>
          </span>
          <span class="tool__label">Elements</span>
        </button>
        <button class="tool" type="button" aria-label="Text" data-tool="text">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M5 5h14M12 5v14"/>
            </svg>
          </span>
          <span class="tool__label">Text</span>
        </button>
        <button class="tool" type="button" aria-label="Edit" data-tool="edit">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 21l3-1 12-12-2-2L4 18l-1 3z"/>
              <path d="M14 4l2 2"/>
            </svg>
          </span>
          <span class="tool__label">Edit</span>
        </button>
        <button class="tool" type="button" aria-label="Layers" data-tool="layers">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 3l9 5-9 5-9-5 9-5z"/>
              <path d="M21 13l-9 5-9-5"/>
              <path d="M21 17l-9 5-9-5"/>
            </svg>
          </span>
          <span class="tool__label">Layers</span>
        </button>
      </nav>

      <!-- ORDER TOOLBAR -->
      <nav class="toolbar" data-section="order" role="navigation" aria-label="Order tools">
        <button class="tool" type="button" aria-label="Shop 1">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 9l2-5h14l2 5"/>
              <path d="M4 9h16v10H4z"/>
              <path d="M9 19v-6h6v6"/>
            </svg>
          </span>
          <span class="tool__label">Shop 1</span>
        </button>
        <button class="tool" type="button" aria-label="Shop 2">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 9h12l-1.5 11H7.5L6 9z"/>
              <path d="M9 9V7a3 3 0 0 1 6 0v2"/>
            </svg>
          </span>
          <span class="tool__label">Shop 2</span>
        </button>
        <button class="tool" type="button" aria-label="eBay">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 13l-7 7-9-9 7-7 9 9z"/>
              <circle cx="15.5" cy="8.5" r="1.2"/>
            </svg>
          </span>
          <span class="tool__label">eBay</span>
        </button>
        <button class="tool" type="button" aria-label="Etsy">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="9"/>
              <path d="M9 8h6M9 12h5M9 16h6"/>
            </svg>
          </span>
          <span class="tool__label">Etsy</span>
        </button>
        <button class="tool" type="button" aria-label="Amazon">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="9" cy="20" r="1.6"/>
              <circle cx="17" cy="20" r="1.6"/>
              <path d="M3 5h3l2 10h9l2-7H7"/>
            </svg>
          </span>
          <span class="tool__label">Amazon</span>
        </button>
        <button class="tool" type="button" aria-label="Design Link">
          <span class="tool__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
              <path d="M10 14l-2 2a4 4 0 0 1-6-6l2-2"/>
              <path d="M14 10l2-2a4 4 0 0 1 6 6l-2 2"/>
              <path d="M8 12h8"/>
            </svg>
          </span>
          <span class="tool__label">Design Link</span>
        </button>
      </nav>
    </div>
  </div>

  <script>
    // ===== Section switching (header) =====
    const headerButtons = document.querySelectorAll('.header-tools .tool');
    function setActive(section){
      document.documentElement.setAttribute('data-active-section', section);
      headerButtons.forEach(btn => {
        if(btn.dataset.section === section){
          btn.setAttribute('aria-current', 'page');
        }else{
          btn.removeAttribute('aria-current');
        }
      });
      // If leaving Design, close any open overlay and unpress design tools
      if(section !== 'design'){
        setDesignPage('');
      }
    }
    headerButtons.forEach(btn => {
      btn.addEventListener('click', () => setActive(btn.dataset.section));
      btn.addEventListener('keydown', (e) => { if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); setActive(btn.dataset.section); } });
    });

    // ===== Design toolbar -> overlays =====
    const designButtons = document.querySelectorAll('.toolbar[data-section="design"] .tool');

    function setDesignPage(page){
      document.documentElement.setAttribute('data-design-page', page);
      designButtons.forEach(btn => {
        const isActive = btn.dataset.tool === page && !!page;
        if(isActive){ btn.setAttribute('aria-pressed', 'true'); }
        else { btn.removeAttribute('aria-pressed'); }
      });
    }

    designButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const page = btn.dataset.tool;
        // If clicking another tool, switch. Clicking the same tool keeps it open (no toggle off per requirement).
        setActive('design');
        setDesignPage(page);
      });
      btn.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); setActive('design'); setDesignPage(btn.dataset.tool); }
      });
    });

    // ===== Overlay close buttons =====
    document.querySelectorAll('.overlay-close').forEach(x => {
      x.addEventListener('click', () => setDesignPage(''));
    });

    // Ensure initial state matches attributes
    setActive(document.documentElement.getAttribute('data-active-section') || 'wares');
    setDesignPage(document.documentElement.getAttribute('data-design-page') || '');
  </script>
</body>
</html>
