<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mobile Layout with Zoomable SVG View</title>

  <!-- Material Symbols (compact icons) -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />

  <style>
    /*
    =========================================================
    CSS CUSTOM PROPERTIES (EASY KNOBS)
    =========================================================
    */
    :root{
      /* Main stack proportions */
      --header-height: 5%;
      --preview-height: 60%;
      --controls-height: 35%;

      /* Controls splits */
      --controls-top: 15%;
      --controls-middle: 60%;
      --controls-bottom: 25%;

      /* 5-column layout widths (adjust these %) */
      --col-view: 30%;
      --col-gap1: 10%;
      --col-adjust: 20%;
      --col-gap2: 10%;
      --col-overlay: 30%;

      /* Spacing + colors */
      --outer-gap: 5px;
      --inner-gap: 4px;

      --bg-page: #f0f0f0;
      --bg-app:  #e0e0e0;

      --bg-header:  #2196f3;
      --bg-controls:#bbdefb;

      --bg-ctrl-top:    #ffe0b2;
      --bg-ctrl-middle: #ffe082;
      --bg-ctrl-bottom: #ffcc80;

      /* Frame + design styles */
      --frame-stroke: rgba(255,255,255,0.95);
      --frame-stroke-width: 2.5;
      --frame-dash: 7 6;
      --design-fill: rgba(255,255,255,0.22);
      --design-stroke: rgba(255,255,255,0.45);
      --design-stroke-width: 1.5;

      /* ===== Toolbar tuning knobs ===== */
      --toolbar-gap: 16px;                 /* gap between the 7 items - was 8px — doubles gaps between buttons*/
      --toolbar-padding: 12px;             /* inner padding of toolbar-region  - was 6px — doubles space to parent edges*/
      --toolbar-icon-size: 28px;          /* actual icon font-size */
      --toolbar-icon-box: 36px;           /* square box for consistent footprint */
      --toolbar-label-size: 0.75rem;      /* label typography */
      --toolbar-accent: #ffffff;          /* button bg */
      --toolbar-ink: #333333;             /* button text/icon color */
      --toolbar-ink-active: #000000;      /* active/pressed state */
      --toolbar-btn-radius: 12px;         /* button corner radius */
      --toolbar-btn-padY: 12px;            /* vertical padding inside each button - was 6px — doubles inside top/bottom padding*/
      --toolbar-btn-padX: 12px;            /* horizontal padding inside each button - was 6px — doubles inside left/right padding */
    }

    /* =========================================================
       BASE PAGE
       ========================================================= */
    html, body {
      margin: 0; padding: 0;
      height: 100%; width: 100%;
      background: var(--bg-page);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .main-mobile-app-region{
      margin: 5px;
      width: calc(100% - 10px);
      height: calc(100% - 10px);
      background: var(--bg-app);
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      display: flex;
      flex-direction: column;
      gap: var(--outer-gap);
      overflow: hidden;
    }

    .header-region{
      flex: 0 0 var(--header-height);
      background: var(--bg-header);
      color: #fff;
      display: flex; align-items: center; justify-content: center;
      border-radius: 8px;
      padding: 0 8px; box-sizing: border-box;
    }

    /*
    =========================================================
    PREVIEW: edge-to-edge, no visual chrome
    =========================================================
    */
    .preview-region{
      flex: 0 0 var(--preview-height);
      background: transparent;
      border-radius: 0;
      display: grid; place-items: stretch;
      padding: 0;
      overflow: hidden;
    }

    .preview-viewport{
      width: 100%;
      height: 100%;
      position: relative;       /* anchor stacking context for overlay SVG */
      background: transparent;
      padding: 0;
      border: none;
      border-radius: 0;
      box-shadow: none;
      overflow: hidden;
    }

    /* The main scene (raster + overlays) fills the viewport */
    .scene-svg{
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      pointer-events: none;
    }

    /* Separate overlay SVG just for the frame */
    .frame-svg{
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: none;            /* hidden until toggled */
      pointer-events: none;     /* purely decorative; never intercept input */
    }
    .preview-viewport.show-frame .frame-svg{
      display: block;
    }

    .frameRect--design {
      fill: none;
      stroke: var(--frame-stroke);
      stroke-width: var(--frame-stroke-width);
      stroke-dasharray: var(--frame-dash);
      vector-effect: non-scaling-stroke;
    }

    .design-area{ display: none; }
    .preview-viewport.show-design .design-area{ display: block; }

    /* ---------------------------------------------------------
       Controls
       --------------------------------------------------------- */
    .controls-region{
      flex: 0 0 var(--controls-height);
      background: var(--bg-controls);
      color: #000;
      border-radius: 8px;
      display: flex; flex-direction: column;
      gap: var(--inner-gap);
      padding: var(--inner-gap); box-sizing: border-box;
    }

    .preview-selection-region{
      flex: 0 0 var(--controls-top);
      background: var(--bg-ctrl-top);
      border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      padding: 6px; box-sizing: border-box;
    }

    /* ======= 5-column selection bar ======= */
    .selection-inner{
      width: 100%; max-width: 900px;
      display: grid;
      grid-template-columns:
        var(--col-view)
        var(--col-gap1)
        var(--col-adjust)
        var(--col-gap2)
        var(--col-overlay);
      align-items: center; gap: 8px;
    }
    .col{ display:flex; align-items:center; justify-content:center; }

    /* View switch (Preview/Edit) */
    .view-switch{
      display: inline-flex; align-items: center; gap: 10px;
      background: #fff; padding: 6px 10px; border-radius: 999px;
      box-shadow: 0 1px 0 rgba(0,0,0,0.05);
      font-weight: 700;
      font-size: clamp(0.85rem, 3vw, 0.95rem);
    }
    .switch {
      --h: 22px; --w: 42px;
      position: relative; width: var(--w); height: var(--h);
    }
    .switch input{ display:none; }
    .slider{
      position:absolute; inset:0; cursor:pointer;
      background:#ddd; border-radius:999px;
      transition: background .2s ease;
    }
    .slider:before{
      content:""; position:absolute; height:18px; width:18px;
      left:2px; top:2px; border-radius:50%;
      background:#fff; box-shadow: 0 1px 2px rgba(0,0,0,.25);
      transition: transform .2s ease;
    }
    .switch input:checked + .slider{ background:#333; }
    .switch input:checked + .slider:before{ transform: translateX(20px); }

    /* Adjust button (hidden in Preview, visible in Edit) */
    .btn-adjust{
      appearance: none; border: none; cursor: pointer;
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px; border-radius: 10px;
      background: #fff; color:#333; font-weight:700;
      box-shadow: 0 1px 0 rgba(0,0,0,0.05);
      font-size: clamp(0.85rem, 3vw, 0.95rem);
      visibility: hidden; opacity: 0; transform: translateY(-2px);
      transition: opacity .15s ease, transform .15s ease, visibility 0s .15s;
    }
    #appRoot.is-edit .btn-adjust{
      visibility: visible; opacity: 1; transform: translateY(0);
      transition: opacity .15s ease, transform .15s ease;
    }

    .toggle-icons{
      display: inline-flex; gap: 6px;
      background: rgba(0,0,0,0.04);
      border-radius: 999px; padding: 4px;
    }
    .icon-toggle{
      appearance: none; border: none;
      display: inline-flex; align-items: center; justify-content: center;
      gap: 6px; border-radius: 999px;
      padding: 8px 10px; font-weight: 600;
      font-size: clamp(0.85rem, 3.2vw, 0.95rem);
      background: #fff; color: #333;
      box-shadow: 0 1px 0 rgba(0,0,0,0.05);
      cursor: pointer;
    }
    .icon-toggle .material-symbols-rounded{
      font-variation-settings: "FILL" 0, "wght" 500, "GRAD" 0, "opsz" 24;
      font-size: 1.15em; line-height: 1;
    }
    .icon-toggle[aria-pressed="true"]{ background:#333; color:#fff; }

    .future-controls-region{
      flex: 0 0 var(--controls-middle);
      background: var(--bg-ctrl-middle);
      border-radius: 8px;
      display: flex; align-items: center; justify-content: center;
      text-align: center; overflow: auto;
      padding: 6px; box-sizing: border-box;
    }

    /*
    =========================================================
    TOOLBAR (7 evenly-spaced buttons, icon over label)
    =========================================================
    */
    .toolbar-region{
      flex: 0 0 var(--controls-bottom);
      background: var(--bg-ctrl-bottom);
      border-radius: 8px;
      display: grid;
      align-items: center;
      padding: var(--toolbar-padding);
      box-sizing: border-box;
    }

    /* Grid with seven equal columns for perfect even spacing */
    .toolbar-grid{
      width: 100%;
      height: 100%;
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: var(--toolbar-gap);
      align-items: stretch;
      justify-items: stretch;
    }

    /* Each toolbar item (button) */
    .toolbar-btn{
      appearance: none; border: none; cursor: pointer;
      background: var(--toolbar-accent);
      color: var(--toolbar-ink);
      border-radius: var(--toolbar-btn-radius);
      padding: var(--toolbar-btn-padY) var(--toolbar-btn-padX);
      display: flex;
      flex-direction: column;          /* icon above label */
      align-items: center;
      justify-content: center;
      gap: 4px;
      box-shadow: 0 1px 0 rgba(0,0,0,0.05);
      transition: transform .08s ease, box-shadow .08s ease, color .15s ease;
      min-height: 100%;                /* equal height cards */
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .toolbar-btn:active{ transform: translateY(1px); }
    .toolbar-btn:focus-visible{ outline: 2px solid rgba(0,0,0,0.25); outline-offset: 2px; }

    /* Fixed square box to make all icons visually identical in size & footprint */
    .tool-icon{
      width: var(--toolbar-icon-box);
      height: var(--toolbar-icon-box);
      display: grid;
      place-items: center;             /* perfectly center glyph in box */
    }
    .tool-icon .material-symbols-rounded{
      font-variation-settings: "FILL" 0, "wght" 500, "GRAD" 0, "opsz" 24;
      font-size: var(--toolbar-icon-size);
      line-height: 1;
    }

    .tool-label{
      font-size: var(--toolbar-label-size);
      font-weight: 700;
      line-height: 1.1;
      text-align: center;
      white-space: nowrap;
    }

    /* Optional pressed/selected state — apply with [aria-pressed="true"] if needed later */
    .toolbar-btn[aria-pressed="true"]{
      color: var(--toolbar-ink-active);
      box-shadow: inset 0 0 0 2px rgba(0,0,0,0.12);
    }

    .region-label{ font-weight:700; font-size:clamp(0.95rem, 4.2vw, 1.25rem); }
  </style>
</head>
<body>

  <div id="appRoot" class="main-mobile-app-region">
    <!-- HEADER -->
    <div class="header-region">
      <div class="region-label">Header Region (≈5%)</div>
    </div>

    <!-- PREVIEW -->
    <div class="preview-region">
      <div class="preview-viewport mode-preview" id="previewViewport">
        <!--
          SINGLE SVG SCENE
          - Base raster: 1155×1155.
          - Overlays use the same coordinate system.
          - PREVIEW: viewBox="0 0 1155 1155"  (full image)
          - EDIT:    computed dynamically from DESIGN_RECT + offsets (see JS)
        -->
        <svg id="sceneSvg"
             class="scene-svg"
             viewBox="0 0 1155 1155"
             preserveAspectRatio="xMidYMid meet"
             aria-hidden="true">
          <!-- Base image -->
          <image
            href="assets/img/demo/product-preview.png"
            x="0" y="0" width="1155" height="1155"
            preserveAspectRatio="none" />

          <!-- svg-design-area: toggled by “Design” (purely illustrative fill) -->
          <g class="design-area" id="svg-design-area">
            <rect x="361" y="180" width="440" height="583"
                  fill="var(--design-fill)"
                  stroke="var(--design-stroke)"
                  stroke-width="var(--design-stroke-width)" />
          </g>
        </svg>

        <!-- Overlay SVG for the frame -->
        <svg id="frameSvg"
             class="frame-svg"
             viewBox="0 0 1155 1155"
             preserveAspectRatio="xMidYMid meet"
             aria-hidden="true">
          <rect id="frameRectDesign"
                class="frameRect--design"
                x="361" y="180" width="440" height="583" />
        </svg>

      </div>
    </div>

    <!-- CONTROLS -->
    <div class="controls-region">
      <div class="preview-selection-region">
        <div class="selection-inner">
          <!-- Column 1: View -->
          <div class="col col-view">
            <div class="view-switch" role="group" aria-label="View mode">
              <span>Preview</span>
              <label class="switch" aria-label="Toggle Edit Mode">
                <input id="modeSwitch" type="checkbox" />
                <span class="slider"></span>
              </label>
              <span>Edit</span>
            </div>
          </div>

          <!-- Column 2: Spacer -->
          <div class="col col-gap1"></div>

          <!-- Column 3: Adjust -->
          <div class="col col-adjust">
            <button id="btnAdjust" class="btn-adjust" type="button" title="Adjust (Edit mode)">
              <span class="material-symbols-rounded" aria-hidden="true">edit</span>
              <span>Adjust</span>
            </button>
          </div>

          <!-- Column 4: Spacer -->
          <div class="col col-gap2"></div>

          <!-- Column 5: Overlay -->
          <div class="col col-overlay">
            <div class="toggle-icons" role="group" aria-label="Overlays">
              <button id="btnFrame" class="icon-toggle" type="button"
                      aria-pressed="false" title="Show/Hide Frame">
                <span class="material-symbols-rounded" aria-hidden="true">crop_free</span>
                <span class="label">Frame</span>
              </button>
              <button id="btnDesign" class="icon-toggle" type="button"
                      aria-pressed="false" title="Show/Hide Design">
                <span class="material-symbols-rounded" aria-hidden="true">layers</span>
                <span class="label">Design</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="future-controls-region">
        <div class="region-label">Future Controls (custom UI goes here)</div>
      </div>

      <!-- ======================================================
           TOOLBAR: 7 BUTTONS, ICON OVER LABEL, EVENLY SPACED
           ====================================================== -->
      <div class="toolbar-region">
        <div class="toolbar-grid" role="toolbar" aria-label="Editor toolbar">
          <!-- 1) Product -->
          <button id="toolProduct" class="toolbar-btn" type="button" title="Product">
            <span class="tool-icon" aria-hidden="true">
              <span class="material-symbols-rounded">storefront</span>
            </span>
            <span class="tool-label">Product</span>
          </button>

          <!-- 2) Colors -->
          <button id="toolColors" class="toolbar-btn" type="button" title="Colors">
            <span class="tool-icon" aria-hidden="true">
              <span class="material-symbols-rounded">palette</span>
            </span>
            <span class="tool-label">Colors</span>
          </button>

          <!-- 3) Designs -->
          <button id="toolDesigns" class="toolbar-btn" type="button" title="Designs">
            <span class="tool-icon" aria-hidden="true">
              <span class="material-symbols-rounded">auto_awesome</span>
            </span>
            <span class="tool-label">Designs</span>
          </button>

          <!-- 4) Elements -->
          <button id="toolElements" class="toolbar-btn" type="button" title="Elements">
            <span class="tool-icon" aria-hidden="true">
              <span class="material-symbols-rounded">widgets</span>
            </span>
            <span class="tool-label">Elements</span>
          </button>

          <!-- 5) Text -->
          <button id="toolText" class="toolbar-btn" type="button" title="Text">
            <span class="tool-icon" aria-hidden="true">
              <span class="material-symbols-rounded">text_fields</span>
            </span>
            <span class="tool-label">Text</span>
          </button>

          <!-- 6) Layers -->
          <button id="toolLayers" class="toolbar-btn" type="button" title="Layers">
            <span class="tool-icon" aria-hidden="true">
              <span class="material-symbols-rounded">layers</span>
            </span>
            <span class="tool-label">Layers</span>
          </button>

          <!-- 7) Export -->
          <button id="toolExport" class="toolbar-btn" type="button" title="Export">
            <span class="tool-icon" aria-hidden="true">
              <span class="material-symbols-rounded">ios_share</span>
            </span>
            <span class="tool-label">Export</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    /*
    ==========================================================
    VIEW / EDIT MODE + FRAME OVERLAY SYNC
    ----------------------------------------------------------
    The toolbar buttons are just UI at this stage; they have
    stable IDs so you can wire handlers later.
    ==========================================================
    */

    /** DOM refs */
    const appRoot   = document.getElementById('appRoot');
    const viewport  = document.getElementById('previewViewport');
    const sceneSvg  = document.getElementById('sceneSvg');
    const frameSvg  = document.getElementById('frameSvg');

    const modeSwitch = document.getElementById('modeSwitch'); // unchecked=Preview, checked=Edit

    const btnFrame  = document.getElementById('btnFrame');
    const btnDesign = document.getElementById('btnDesign');

    /** Constants: image + design rect geometry */
    const VIEWBOX_PREVIEW = { x: 0,   y: 0,   w: 1155, h: 1155 };
    const DESIGN_RECT     = { x: 361, y: 180, w: 440,  h: 583  };
    const IMAGE_BOUNDS    = { x: 0, y: 0, w: 1155, h: 1155 };

    /** Mutable: track which viewBox is active (single source of truth) */
    let currentViewBox = { ...VIEWBOX_PREVIEW };

    /* --------------------------------------------------------
       UTILS
       -------------------------------------------------------- */
    function clampRectToBounds(rect, bounds){
      let { x, y, w, h } = rect;
      if (w > bounds.w) w = bounds.w;
      if (h > bounds.h) h = bounds.h;
      if (x < bounds.x) x = bounds.x;
      if (y < bounds.y) y = bounds.y;
      if (x + w > bounds.x + bounds.w) x = bounds.x + bounds.w - w;
      if (y + h > bounds.y + bounds.h) y = bounds.y + bounds.h - h;
      return { x, y, w, h };
    }

    function expandRectByOffsets(rect, offsets){
      const pad = { top:0, right:0, bottom:0, left:0, ...offsets };
      let x = rect.x - pad.left;
      let y = rect.y - pad.top;
      let w = rect.w + pad.left + pad.right;
      let h = rect.h + pad.top + pad.bottom;
      return clampRectToBounds({ x, y, w, h }, IMAGE_BOUNDS);
    }

    function buildEditViewBox(offsets){
      return expandRectByOffsets(DESIGN_RECT, offsets);
    }

    function setViewBox({x, y, w, h}) {
      const vb = `${x} ${y} ${w} ${h}`;
      sceneSvg.setAttribute('viewBox', vb);
      frameSvg.setAttribute('viewBox', vb);
      currentViewBox = { x, y, w, h };
    }

    function setMode(isPreview){
      appRoot.classList.toggle('is-edit', !isPreview);
      viewport.classList.toggle('mode-preview', isPreview);
      viewport.classList.toggle('mode-edit', !isPreview);

      const DEFAULT_EDIT_OFFSETS = { top: 25, right: 25, bottom: 25, left: 25 };
      const editVB = buildEditViewBox(DEFAULT_EDIT_OFFSETS);
      setViewBox(isPreview ? VIEWBOX_PREVIEW : editVB);
    }

    // Wire the switch: unchecked=Preview, checked=Edit
    modeSwitch.addEventListener('change', () => {
      const isEdit = modeSwitch.checked;
      setMode(!isEdit ? true : false); // true=Preview, false=Edit
    });

    function togglePressed(btn){
      const now = btn.getAttribute('aria-pressed') !== 'true';
      btn.setAttribute('aria-pressed', String(now));
      return now;
    }

    btnFrame.addEventListener('click', () => {
      const on = togglePressed(btnFrame);
      viewport.classList.toggle('show-frame', on);
    });

    btnDesign.addEventListener('click', () => {
      const on = togglePressed(btnDesign);
      viewport.classList.toggle('show-design', on);
    });

    // ---- Initial state ----
    modeSwitch.checked = false;
    setMode(true);
  </script>
</body>
</html>
